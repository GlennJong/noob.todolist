<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Noob todolist</title>
	<link rel="stylesheet" href="css/stylesheet.css">
</head>
<body>
	<!-- <script src="js/myscript.js"></script> -->
	<script>
	  var globalID = 0
	  function Todo(title) {
	    this.id = globalID++
	    this.title = title || ""
	    this.done = false
	    this.$elem = this.createElem()
	    this.bindEvents()
	    return this
	  }
	  Todo.prototype.createElem = function () {
	    var $li = document.createElement('li')
	    var $button = document.createElement('button')
	    $li.textContent = this.title
	    $button.textContent = '刪除'
	    $li.appendChild($button)
	    return $li
	  }
	  Todo.prototype.bindEvents = function () {
	    this.$elem.querySelector('button').addEventListener('click', this.onRemove.bind(this))
	  }
	  Todo.prototype.onRemove = function () {
	    if (this.list) {
	    	console.log(this)
	      this.list.remove(this)
	      var x = this.list
	    }
	  }
	  function TodoList() {
	    this.todos = []
	    this.$elem = this.createElem()
	    this.bindEvents()
	  }
	  TodoList.prototype.createElem = function () {
	    var $container = document.createElement('div')
	    var $input = document.createElement('input')
	    var $button = document.createElement('button')
	    var $ul = document.createElement('ul')
	    $input.setAttribute('type', 'text')
	    $button.textContent = '新增事項'
	    $container.appendChild($input)
	    $container.appendChild($button)
	    $container.appendChild($ul)
	    return $container
	  }
	  TodoList.prototype.bindEvents = function () {
	    this.$elem.querySelector('button').addEventListener('click', this.onCreateTodo.bind(this))
	  }
	  TodoList.prototype.onCreateTodo = function () {
	    var input = this.$elem.querySelector('input')
	    var value = input.value
	    var todo = new Todo(value)
	    this.add(todo)
	    input.value = ""
	  }
	  TodoList.prototype.add = function (todo) {
	    todo.list = this
	    this.todos.push(todo)
	    this.$elem.append(todo.$elem)
	  }
	  TodoList.prototype.remove = function (todo) {
	    var todo = this.findTodo(todo)
	    if (todo) {
	      todo.$elem.remove()
	    }
	  }
	  TodoList.prototype.findTodo = function (todo) {
	    var index = this.todos.indexOf(todo)
	    return this.todos[index]
	  }
	  function App() {
	    this.createTodoList()
	  }
	  App.prototype.createTodoList = function () {
	    var list = new TodoList()
	    document.body.appendChild(list.$elem)
	  }
	  window.app = new App()
	</script>
</body>
</html>